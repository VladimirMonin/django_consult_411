# –¢–µ–º–∞ Django ORM –ß2. CRUD-–∑–∞–ø—Ä–æ—Å—ã, QuerySet, —Å–≤—è–∑–∏ ¬´–æ–¥–∏–Ω-–∫–æ-–º–Ω–æ–≥–∏–º¬ª. –£—Ä–æ–∫ 55 üêç

## –°–∏—Å—Ç–µ–º–∞ –º–æ–¥–µ–ª–µ–π üèóÔ∏è

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –º–æ–¥–µ–ª–∏ Master –∏ Order, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å—É—â–Ω–æ—Å—Ç–∏ "–ú–∞—Å—Ç–µ—Ä" –∏ "–ó–∞–∫–∞–∑" –≤ –Ω–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:

```python
class Master(models.Model):
    first_name = models.CharField(max_length=100, verbose_name="–ò–º—è")
    last_name = models.CharField(max_length=100, verbose_name="–§–∞–º–∏–ª–∏—è")
    middle_name = models.CharField(
        null=True, blank=True, max_length=100, verbose_name="–û—Ç—á–µ—Å—Ç–≤–æ"
    )
    phone = models.CharField(max_length=20, verbose_name="–¢–µ–ª–µ—Ñ–æ–Ω", default="00000000000")
    email = models.EmailField(null=True, blank=True, verbose_name="Email")

    def __str__(self):
        return f"{self.first_name} {self.last_name}"

    class Meta:
        # –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ - –≤ –µ–¥. —á–∏—Å–ª–µ –∏ –º–Ω. —á–∏—Å–ª–µ
        verbose_name = "–ú–∞—Å—Ç–µ—Ä"
        verbose_name_plural = "–ú–∞—Å—Ç–µ—Ä–∞"
        # —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ñ–∞–º–∏–ª–∏–∏ –∏ –∏–º–µ–Ω–∏
        ordering = ["last_name", "first_name"]
```

### –ü–æ—è—Å–Ω–µ–Ω–∏—è –∫ –º–æ–¥–µ–ª–∏ Master:
- `first_name`, `last_name` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è (CharField) —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –¥–ª–∏–Ω—ã 100 —Å–∏–º–≤–æ–ª–æ–≤
- `middle_name` - –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ (–º–æ–∂–µ—Ç –±—ã—Ç—å NULL –≤ –ë–î –±–ª–∞–≥–æ–¥–∞—Ä—è `null=True`, –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ñ–æ—Ä–º—ã –±–ª–∞–≥–æ–¥–∞—Ä—è `blank=True`)
- `phone` - —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º "00000000000"
- `email` - –ø–æ–ª–µ –¥–ª—è email —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Ñ–æ—Ä–º–∞—Ç–∞, –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ
- `__str__` - –º–µ—Ç–æ–¥ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞
- `Meta` - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–ª–∞—Å—Å –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–∏:
  - `verbose_name` - —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –∏–º—è –≤ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–º —á–∏—Å–ª–µ
  - `verbose_name_plural` - —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –∏–º—è –≤–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —á–∏—Å–ª–µ
  - `ordering` - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

```python
class Order(models.Model):
    name = models.CharField(max_length=100, verbose_name="–ò–º—è")
    phone = models.CharField(max_length=20, verbose_name="–¢–µ–ª–µ—Ñ–æ–Ω")
    comment = models.TextField(verbose_name="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π", null=True, blank=True)
    master = models.ForeignKey(Master, verbose_name="–ú–∞—Å—Ç–µ—Ä", default=None, on_delete=models.SET_DEFAULT, related_name="orders")
```

### –ü–æ—è—Å–Ω–µ–Ω–∏—è –∫ –º–æ–¥–µ–ª–∏ Order:
- `name`, `phone` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞
- `comment` - –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- `master` - —Å–≤—è–∑—å "–æ–¥–∏–Ω-–∫–æ-–º–Ω–æ–≥–∏–º" —Å –º–æ–¥–µ–ª—å—é Master:
  - `on_delete=models.SET_DEFAULT` - –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –º–∞—Å—Ç–µ—Ä–∞, –∑–∞–∫–∞–∑—ã –æ—Å—Ç–∞–Ω—É—Ç—Å—è —Å master_id=NULL
  - `related_name="orders"` - –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –≤—Å–µ –∑–∞–∫–∞–∑—ã –º–∞—Å—Ç–µ—Ä–∞ —á–µ—Ä–µ–∑ `master.orders.all()`

–ù–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç —Å–∏—Å—Ç–µ–º–∞ –º–æ–¥–µ–ª–µ–π –æ—Å—Ç–∞–ª–∞—Å—å —Å –ø—Ä–æ—à–ª–æ–≥–æ –∑–∞–Ω—è—Ç–∏—è –Ω–µ–∏–∑–º–µ–Ω–Ω–æ–π.
–ò–∑–º–µ–Ω–∏–ª–æ—Å—å –ª–∏—à—å —Ç–æ —á—Ç–æ –º—ã –¥–æ–±–∞–≤–∏–ª–∏ `related_name="orders"` –≤ –º–æ–¥–µ–ª—å `Order`, —á—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∞–µ—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –æ–±—Ä–∞—Ç–Ω—ã–º–∏ —Å–≤—è–∑—è–º–∏.

## –ü–æ–¥—Ä–æ–±–Ω–µ–µ –ø—Ä–æ `related_name` üîÑ

–ö–æ–≥–¥–∞ –º—ã —Å–æ–∑–¥–∞–µ–º —Å–≤—è–∑—å ForeignKey (–æ–¥–∏–Ω-–∫–æ-–º–Ω–æ–≥–∏–º), Django –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å. –ë–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è `related_name` –¥–æ—Å—Ç—É–ø –∫ —Å–≤—è–∑–∞–Ω–Ω—ã–º –æ–±—ä–µ–∫—Ç–∞–º –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `–∏–º—è_–º–æ–¥–µ–ª–∏_set` (–≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –±—ã–ª–æ –±—ã `order_set`).

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `related_name="orders"` –¥–∞–µ—Ç –Ω–∞–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤:

1. **–£–ª—É—á—à–µ–Ω–Ω–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞**:
```python
# –ë–µ–∑ related_name
master.order_set.all()  # –º–µ–Ω–µ–µ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ

# –° related_name
master.orders.all()    # –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω–æ
```

2. **–ë–æ–ª–µ–µ –ª–æ–≥–∏—á–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è** - –º—ã –º–æ–∂–µ–º –≤—ã–±—Ä–∞—Ç—å –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ–µ –∏–º—è –¥–ª—è —Å–≤—è–∑–∏.

3. **–ò–∑–±–µ–≥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤** - –µ—Å–ª–∏ –±—ã —É –Ω–∞—Å –±—ã–ª–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–≤—è–∑–µ–π —Å –æ–¥–Ω–æ–π –º–æ–¥–µ–ª—å—é, related_name –ø–æ–º–æ–≥–∞–µ—Ç –∏—Ö —Ä–∞–∑–ª–∏—á–∞—Ç—å.

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```python
# –ü–æ–ª—É—á–∞–µ–º –º–∞—Å—Ç–µ—Ä–∞
master = Master.objects.get(pk=1)

# –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –µ–≥–æ –∑–∞–∫–∞–∑—ã —á–µ—Ä–µ–∑ related_name
orders = master.orders.all()  # –≤–º–µ—Å—Ç–æ master.order_set.all()

# –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
recent_orders = master.orders.filter(created_at__gte=timezone.now() - timedelta(days=7))
```

–í–∞–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ –¥–ª—è related_name, —á—Ç–æ–±—ã –∫–æ–¥ –æ—Å—Ç–∞–≤–∞–ª—Å—è –ø–æ–Ω—è—Ç–Ω—ã–º.

## Shell Plus - –∑–∞–ø—É—Å–∫ –≤ `print sql` —Ä–µ–∂–∏–º–µ üîç

Django Shell Plus —Å —Ñ–ª–∞–≥–æ–º `--print-sql` - –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è ORM:

```bash
poetry run python manage.py shell_plus --print-sql
```

### –ß—Ç–æ –¥–∞–µ—Ç `--print-sql`?
1. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ SQL-–∑–∞–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ Django –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º
2. –ü–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω—è—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç QuerySet'—ã
3. –ü–æ–∑–≤–æ–ª—è–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤
4. –£—á–∏—Ç –ø–∏—Å–∞—Ç—å –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:
```python
# –í –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ –º—ã –≤–∏–¥–∏–º —Ç–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
Master.objects.all()
# <QuerySet [<Master: –ì–µ–Ω–¥–∞–ª—å—Ñ –°–µ—Ä—ã–π>, <Master: –ì–µ–Ω–¥–∞–ª—å—Ñ –ë–µ–ª—ã–π>]>

# –í —Ä–µ–∂–∏–º–µ --print-sql –º—ã –≤–∏–¥–∏–º —Å–∞–º –∑–∞–ø—Ä–æ—Å:
"""
SELECT "core_master"."id",
       "core_master"."first_name",
       "core_master"."last_name",
       "core_master"."middle_name",
       "core_master"."phone",
       "core_master"."email"
  FROM "core_master"
 ORDER BY "core_master"."last_name" ASC,
          "core_master"."first_name" ASC
 LIMIT 21
Execution time: 0.000149s [Database: default]
"""
```

### –°–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
1. –û–±—Ä–∞—â–∞–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ (N+1 –ø—Ä–æ–±–ª–µ–º–∞)
2. –°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (Execution time)
3. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ (JOIN'—ã, –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã)
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ —Å–ª–æ–∂–Ω—ã—Ö —Ü–µ–ø–æ—á–µ–∫ –º–µ—Ç–æ–¥–æ–≤

–≠—Ç–æ—Ç —Ä–µ–∂–∏–º –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–µ–Ω –ø—Ä–∏:
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò–∑—É—á–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã ORM
- –û—Ç–ª–∞–¥–∫–µ —Å–ª–æ–∂–Ω—ã—Ö QuerySet'–æ–≤

## –ó–∞–ø—Ä–æ—Å—ã üìù

### –ú–µ—Ç–æ–¥ `Create` ‚ûï

–ú–µ—Ç–æ–¥ `create()` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—ä–µ–∫—Ç –≤ –ë–î –æ–¥–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π. –≠—Ç–æ —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π.

#### –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Å—Ç–µ—Ä–∞:
```python
master = Master.objects.create(
    first_name="–ì–µ–Ω–¥–∞–ª—å—Ñ",
    last_name="–°–µ—Ä—ã–π",
    phone="12345678901"
)
```

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º:
```txt
>>> master = Master.objects.create(first_name="–ì–µ–Ω–¥–∞–ª—å—Ñ", last_name="–°–µ—Ä—ã–π", phone="12345678901")
INSERT INTO "core_master" ("first_name", "last_name", "middle_name", "phone", "email")
VALUES ('–ì–µ–Ω–¥–∞–ª—å—Ñ', '–°–µ—Ä—ã–π', NULL, '12345678901', NULL) RETURNING "core_master"."id"
Execution time: 0.006985s [Database: default]
```

#### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
1. –°–æ–∑–¥–∞–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ–±—ä–µ–∫—Ç –≤ –æ–¥–Ω–æ–º –º–µ—Ç–æ–¥–µ
2. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç
3. –î–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è
4. –î–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –º–æ–∂–Ω–æ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è (–±—É–¥—É—Ç NULL –∏–ª–∏ default)

#### –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ —Å —Å–≤—è–∑—å—é:
```python
order = Order.objects.create(
    name="–ë–∏–ª—å–±–æ",
    phone="+12345678901",
    master=master,  # –ø–µ—Ä–µ–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –º–∞—Å—Ç–µ—Ä–∞
    comment="–ü–æ–∫—Ä–∞—Å–∫–∞ –±–æ—Ä–æ–¥—ã –ø–µ—Ä–µ–¥ –ø–æ—Ö–æ–¥–æ–º!"
)
```

#### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å create():
- –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç —Å–æ –≤—Å–µ–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –ö–æ–≥–¥–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
- –í —Ç–µ—Å—Ç–∞—Ö –∏ seed-—Å–∫—Ä–∏–ø—Ç–∞—Ö –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ë–î

#### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ - —Å–æ–∑–¥–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä + save():
```python
master = Master(first_name="–ì–µ–Ω–¥–∞–ª—å—Ñ", last_name="–°–µ—Ä—ã–π")
master.save()  # —è–≤–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
```

### –ú–µ—Ç–æ–¥ `Save` üíæ

–ú–µ—Ç–æ–¥ `save()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –æ–±—ä–µ–∫—Ç–µ. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç `create()`, –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∏–ª–∏ –Ω–æ–≤—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏.

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
1. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ create())
2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –æ–±—ä–µ–∫—Ç–∞
3. –ß–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

#### –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞:
```python
# –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î
order2 = Order(name="–°—ç–º", phone="+12345678901")
order2.comment = "–•–æ–±–±–∏—Ç–∞–Ω—Å–∫–∏–π –ø–µ–¥–∏–∫—é—Ä –ø–µ—Ä–µ–¥ –ø–æ—Ö–æ–¥–æ–º!"

# –ü–æ–ø—ã—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–µ–π—á–∞—Å –≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É:
# django.db.utils.IntegrityError: NOT NULL constraint failed: core_order.master_id
# –ø–æ—Ç–æ–º—É —á—Ç–æ master - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ

# –ü–æ–ª—É—á–∞–µ–º –º–∞—Å—Ç–µ—Ä–∞
master = Master.objects.get(pk=1)
order2.master = master

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–∫–∞–∑
order2.save()  # —Ç–µ–ø–µ—Ä—å –æ–±—ä–µ–∫—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –∏ –ø–æ–ª—É—á–∏—Ç id
```

#### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ save():
1. –î–ª—è –Ω–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞:
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è INSERT –∑–∞–ø—Ä–æ—Å
   - –û–±—ä–µ–∫—Ç—É –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è id
2. –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –æ–±—ä–µ–∫—Ç–∞:
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è UPDATE –∑–∞–ø—Ä–æ—Å
   - –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—è

#### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å save() –≤–º–µ—Å—Ç–æ create():
- –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç –ø–æ—ç—Ç–∞–ø–Ω–æ
- –ö–æ–≥–¥–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
- –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- –î–ª—è —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—è)

#### –ü—Ä–∏–º–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
```python
order = Order.objects.get(pk=1)
order.comment = "–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"
order.save()  # –æ–±–Ω–æ–≤–∏—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª–µ comment
```

#### –í–∞–∂–Ω—ã–µ –Ω—é–∞–Ω—Å—ã:
1. `save()` –≤—ã–∑—ã–≤–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—ã –º–æ–¥–µ–ª–∏ (pre_save, post_save)
2. –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å `update_fields` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
   ```python
   order.save(update_fields=['comment'])
   ```
3. –î–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `update()`

## Objects Manager üõ†Ô∏è

–û–±—ä–µ–∫—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä `objects` –≤ Django —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–µ–≤—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º ORM (Object-Relational Mapper) –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –û–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏ Django –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å —Ç–∞–±–ª–∏—Ü–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å —ç—Ç–æ–π –º–æ–¥–µ–ª—å—é.

–í–æ—Ç –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞ –ø–æ `objects`:

### –ß—Ç–æ —Ç–∞–∫–æ–µ `objects`? ü§î

`objects` ‚Äî —ç—Ç–æ —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ [`django.db.models.Manager`](https://docs.djangoproject.com/en/5.0/ref/models/querysets/#manager-methods), –∫–æ—Ç–æ—Ä—ã–π Django –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∫ –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏. –û–Ω —Å–ª—É–∂–∏—Ç —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ß–µ—Ä–µ–∑ `objects` –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –º–µ—Ç–æ–¥–∞–º, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –≤–∞–º –∏–∑–≤–ª–µ–∫–∞—Ç—å, —Å–æ–∑–¥–∞–≤–∞—Ç—å, –æ–±–Ω–æ–≤–ª—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å –æ–±—ä–µ–∫—Ç—ã (–∑–∞–ø–∏—Å–∏) –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏.

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã `QuerySet`, –¥–æ—Å—Ç—É–ø–Ω—ã–µ —á–µ—Ä–µ–∑ `objects` üìã

–ö–æ–≥–¥–∞ –≤—ã –≤—ã–∑—ã–≤–∞–µ—Ç–µ –º–µ—Ç–æ–¥—ã –Ω–∞ `objects`, –æ–Ω–∏ –æ–±—ã—á–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç [`QuerySet`](https://docs.djangoproject.com/en/5.0/ref/models/querysets/), –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏—é –æ–±—ä–µ–∫—Ç–æ–≤ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. `QuerySet`'—ã "–ª–µ–Ω–∏–≤—ã" (lazy), —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –≤—ã —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞—â–∞–µ—Ç–µ—Å—å –∫ –¥–∞–Ω–Ω—ã–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏—Ç–µ—Ä–∏—Ä—É–µ—Ç–µ –ø–æ `QuerySet` –∏–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç–µ –µ–≥–æ –≤ —Å–ø–∏—Å–æ–∫).

–í–æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –º–µ—Ç–æ–¥–æ–≤:

1.  **[`all()`](https://docs.djangoproject.com/en/5.0/ref/models/querysets/#all)**
    *   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π `QuerySet`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏.
    *   –ü—Ä–∏–º–µ—Ä: `Master.objects.all()`

2.  **[`filter(**kwargs)`](https://docs.djangoproject.com/en/5.0/ref/models/querysets/#filter)**
    *   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π `QuerySet`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –æ–±—ä–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∑–∞–¥–∞–Ω–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º –ø–æ–∏—Å–∫–∞. –£—Å–ª–æ–≤–∏—è –∑–∞–¥–∞—é—Ç—Å—è –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ (field lookup).
    *   –ü—Ä–∏–º–µ—Ä: `Master.objects.filter(first_name="–ì–µ–Ω–¥–∞–ª—å—Ñ")`
    *   –ü—Ä–∏–º–µ—Ä —Å `__icontains` (—Ä–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ): `Order.objects.filter(comment__icontains="–±–æ—Ä–æ–¥—ã")`

3.  **[`get(**kwargs)`](https://docs.djangoproject.com/en/5.0/ref/models/querysets/#get)**
    *   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∑–∞–¥–∞–Ω–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º –ø–æ–∏—Å–∫–∞.
    *   –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –∏–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞, –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ (`MultipleObjectsReturned` –∏–ª–∏ `DoesNotExist` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ).
    *   –ü—Ä–∏–º–µ—Ä: `master = Master.objects.get(pk=1)` (–∫–∞–∫ –≤ `notes/lesson_55.md:81`)

4.  **[`exclude(**kwargs)`](https://docs.djangoproject.com/en/5.0/ref/models/querysets/#exclude)**
    *   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π `QuerySet`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –æ–±—ä–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ *–Ω–µ* —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∑–∞–¥–∞–Ω–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º –ø–æ–∏—Å–∫–∞.
    *   –ü—Ä–∏–º–µ—Ä: `Master.objects.exclude(last_name="–°–µ—Ä—ã–π")`

5.  **[`order_by(*fields)`](https://docs.djangoproject.com/en/5.0/ref/models/querysets/#order-by)**
    *   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π `QuerySet`, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ —É–∫–∞–∑–∞–Ω–Ω—ã–º –ø–æ–ª—è–º. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é. –î–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–µ—Ñ–∏–∫—Å `-`.
    *   –ü—Ä–∏–º–µ—Ä: `Master.objects.all().order_by('last_name', '-first_name')`

6.  **[`create(**kwargs)`](https://docs.djangoproject.com/en/5.0/ref/models/querysets/#create)**
    *   –£–¥–æ–±–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –º–æ–¥–µ–ª–∏ –∑–∞ –æ–¥–Ω—É –æ–ø–µ—Ä–∞—Ü–∏—é. –û–Ω —Å–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä –º–æ–¥–µ–ª–∏, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –ø–æ–ª—è –∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç `save()`.
    *   –ü—Ä–∏–º–µ—Ä: `master = Master.objects.create(first_name="–ì–µ–Ω–¥–∞–ª—å—Ñ", last_name="–°–µ—Ä—ã–π", phone="12345678901")` (–∫–∞–∫ –≤ `notes/lesson_55.md:53`)

7.  **[`get_or_create(defaults=None, **kwargs)`](https://docs.djangoproject.com/en/5.0/ref/models/querysets/#get-or-create)**
    *   –ü—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –æ–±—ä–µ–∫—Ç, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π `kwargs`. –ï—Å–ª–∏ –æ–±—ä–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω, –æ–Ω —Å–æ–∑–¥–∞–µ—Ç –µ–≥–æ. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ç–µ–∂ `(object, created)`, –≥–¥–µ `object` ‚Äî —ç—Ç–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç, –∞ `created` ‚Äî –±—É–ª–µ–≤–æ –∑–Ω–∞—á–µ–Ω–∏–µ, —É–∫–∞–∑—ã–≤–∞—é—â–µ–µ, –±—ã–ª –ª–∏ –æ–±—ä–µ–∫—Ç —Å–æ–∑–¥–∞–Ω.
    *   –ü—Ä–∏–º–µ—Ä: `master, created = Master.objects.get_or_create(first_name="–§—Ä–æ–¥–æ", last_name="–ë—ç–≥–≥–∏–Ω—Å", defaults={'phone': '9876543210'})`

8.  **[`update(**kwargs)`](https://docs.djangoproject.com/en/5.0/ref/models/querysets/#update)**
    *   –í—ã–ø–æ–ª–Ω—è–µ—Ç –º–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤ `QuerySet`. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫.
    *   –ü—Ä–∏–º–µ—Ä: `Master.objects.filter(last_name="–°–µ—Ä—ã–π").update(phone="00000000000")`

9.  **[`delete()`](https://docs.djangoproject.com/en/5.0/ref/models/querysets/#delete)**
    *   –í—ã–ø–æ–ª–Ω—è–µ—Ç –º–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤ `QuerySet`. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ç–µ–∂ `(–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—É–¥–∞–ª–µ–Ω–Ω—ã—Ö_–æ–±—ä–µ–∫—Ç–æ–≤, —Å–ª–æ–≤–∞—Ä—å_–ø–æ_—Ç–∏–ø–∞–º_–æ–±—ä–µ–∫—Ç–æ–≤)`.
    *   –ü—Ä–∏–º–µ—Ä: `Master.objects.filter(first_name="–ì–µ–Ω–¥–∞–ª—å—Ñ").delete()`

10. **[`count()`](https://docs.djangoproject.com/en/5.0/ref/models/querysets/#count)**
    *   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ `QuerySet`.
    *   –ü—Ä–∏–º–µ—Ä: `Master.objects.all().count()`

11. **[`first()`](https://docs.djangoproject.com/en/5.0/ref/models/querysets/#first)** –∏ **[`last()`](https://docs.djangoproject.com/en/5.0/ref/models/querysets/#last)**
    *   –í–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø–µ—Ä–≤—ã–π –∏–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –æ–±—ä–µ–∫—Ç –≤ `QuerySet` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –í–æ–∑–≤—Ä–∞—â–∞—é—Ç `None`, –µ—Å–ª–∏ `QuerySet` –ø—É—Å—Ç.
    *   –ü—Ä–∏–º–µ—Ä: `Master.objects.order_by('id').first()`

### –õ–µ–Ω–∏–≤–æ—Å—Ç—å `QuerySet` (Lazy Evaluation) ‚è≥

–ö–∞–∫ —É–ø–æ–º–∏–Ω–∞–ª–æ—Å—å –≤ `notes/lesson_55.md:101`, `QuerySet`'—ã –ª–µ–Ω–∏–≤—ã. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–Ω–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏. –ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ `QuerySet` "–æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è" (evaluated). –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª—É—á–∞—è—Ö:

*   –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ `QuerySet` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Ü–∏–∫–ª–µ `for`).
*   –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ `QuerySet` –≤ —Å–ø–∏—Å–æ–∫ (`list(queryset)`).
*   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ä–µ–∑–æ–≤ (`queryset[0:5]`).
*   –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç (`get()`, `first()`, `last()`).
*   –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç –¥–∞–Ω–Ω—ã–µ (`count()`, `sum()`, `avg()`).
*   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `repr()` –∏–ª–∏ `str()` –¥–ª—è `QuerySet` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –≤—ã–≤–æ–¥–µ –≤ –∫–æ–Ω—Å–æ–ª—å `shell_plus`).

–õ–µ–Ω–∏–≤–æ—Å—Ç—å –ø–æ–∑–≤–æ–ª—è–µ—Ç Django –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –≤—ã–ø–æ–ª–Ω—è—è –∏—Ö —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, –∏ –æ–±—ä–µ–¥–∏–Ω—è—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–π –≤ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å, –µ—Å–ª–∏ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ.

### –¶–µ–ø–æ—á–µ—á–Ω—ã–π —Å—Ç–∏–ª—å (Chain-style) ‚õìÔ∏è

–ú–µ—Ç–æ–¥—ã `QuerySet` —á–∞—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –Ω–æ–≤—ã–π `QuerySet`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç "—Ü–µ–ø–æ—á–µ—á–Ω–æ" –≤—ã–∑—ã–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã. –≠—Ç–æ –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

–ü—Ä–∏–º–µ—Ä:
```python
# –ù–∞–π—Ç–∏ –≤—Å–µ—Ö –º–∞—Å—Ç–µ—Ä–æ–≤ —Å –∏–º–µ–Ω–µ–º "–ì–µ–Ω–¥–∞–ª—å—Ñ", –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Ñ–∞–º–∏–ª–∏–∏ –∏ –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–µ 5
masters = Master.objects.filter(first_name="–ì–µ–Ω–¥–∞–ª—å—Ñ").order_by('last_name')[:5]
```

### `related_name` –∏ –æ–±—Ä–∞—Ç–Ω—ã–µ —Å–≤—è–∑–∏ üîÑ

–í `notes/lesson_55.md:30` —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è `related_name="orders"` –≤ –º–æ–¥–µ–ª–∏ `Order`. –≠—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –¥–ª—è –æ–±—Ä–∞—Ç–Ω—ã—Ö —Å–≤—è–∑–µ–π.

–ö–æ–≥–¥–∞ —É –≤–∞—Å –µ—Å—Ç—å `ForeignKey` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Order.master` —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ `Master`), Django –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç "–æ–±—Ä–∞—Ç–Ω—É—é" —Å–≤—è–∑—å. –ë–µ–∑ `related_name`, –≤—ã –º–æ–≥–ª–∏ –±—ã –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–∫–∞–∑—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–∞—Å—Ç–µ—Ä–∞ —á–µ—Ä–µ–∑ `master_instance.order_set.all()`.

–û–¥–Ω–∞–∫–æ, –∏—Å–ø–æ–ª—å–∑—É—è `related_name="orders"`, –≤—ã –¥–µ–ª–∞–µ—Ç–µ –∫–æ–¥ –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–º –∏ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–º:
```python
# –ü–æ–ª—É—á–∏—Ç—å –º–∞—Å—Ç–µ—Ä–∞ —Å id=1
master = Master.objects.get(pk=1)

# –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–∫–∞–∑—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —ç—Ç–∏–º –º–∞—Å—Ç–µ—Ä–æ–º
# –í–º–µ—Å—Ç–æ master.order_set.all() –∏—Å–ø–æ–ª—å–∑—É–µ–º master.orders.all()
all_orders_for_master = master.orders.all()
```

–≠—Ç–æ –¥–µ–ª–∞–µ—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏—é –ø–æ —Å–≤—è–∑—è–º –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏ –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª–µ–µ —É–¥–æ–±–Ω–æ–π –∏ –ø–æ–Ω—è—Ç–Ω–æ–π.

### –ò—Ç–æ–≥ üéØ

–û–±—ä–µ–∫—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä `objects` ‚Äî —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –≤ Django. –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–æ—â–Ω—ã–π –∏ –≥–∏–±–∫–∏–π API –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è CRUD-–æ–ø–µ—Ä–∞—Ü–∏–π –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `QuerySet`'–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –±–ª–∞–≥–æ–¥–∞—Ä—è –ª–µ–Ω–∏–≤–æ–π –æ—Ü–µ–Ω–∫–µ –∏ —Ü–µ–ø–æ—á–µ—á–Ω–æ–º—É —Å—Ç–∏–ª—é –≤—ã–∑–æ–≤–æ–≤. –ü–æ–Ω–∏–º–∞–Ω–∏–µ –µ–≥–æ —Ä–∞–±–æ—Ç—ã —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–º –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ Django.


## –ú–µ—Ç–æ–¥ `Get` üîç

–ú–µ—Ç–æ–¥ `get()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º. –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏, –∫–æ–≥–¥–∞ –≤—ã –æ–∂–∏–¥–∞–µ—Ç–µ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
1. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —É—Å–ª–æ–≤–∏—è–º
2. –ï—Å–ª–∏ –æ–±—ä–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω - –≤—ã–∑—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ `DoesNotExist`
3. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç–æ–≤ - –≤—ã–∑—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ `MultipleObjectsReturned`
4. –ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –ø–µ—Ä–≤–∏—á–Ω–æ–º—É –∫–ª—é—á—É (pk/id) –∏–ª–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –ø–æ–ª—è–º

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ –ø–µ—Ä–≤–∏—á–Ω–æ–º—É –∫–ª—é—á—É (—Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π —Å–ø–æ—Å–æ–±)
master = Master.objects.get(pk=1)
order = Order.objects.get(pk=1)

# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É –ø–æ–ª—é
master = Master.objects.get(first_name="–ì–µ–Ω–¥–∞–ª—å—Ñ")

# –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
master = Master.objects.get(first_name="–ì–µ–Ω–¥–∞–ª—å—Ñ", last_name="–°–µ—Ä—ã–π")
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π:

–í—Å–µ–≥–¥–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ get():

```python
try:
    master = Master.objects.get(first_name="–ì–µ–Ω–¥–∞–ª—å—Ñ")
except Master.DoesNotExist:
    print("–ú–∞—Å—Ç–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω")
except Master.MultipleObjectsReturned:
    print("–ù–∞–π–¥–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∞—Å—Ç–µ—Ä–æ–≤")
```

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å get():
- –ö–æ–≥–¥–∞ –≤–∞–º –Ω—É–∂–µ–Ω –æ–¥–∏–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ–±—ä–µ–∫—Ç
- –ö–æ–≥–¥–∞ –≤—ã –∏—â–µ—Ç–µ –ø–æ –ø–µ—Ä–≤–∏—á–Ω–æ–º—É –∫–ª—é—á—É –∏–ª–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É –ø–æ–ª—é
- –ö–æ–≥–¥–∞ –≤—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —É—Å–ª–æ–≤–∏—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:
- `filter().first()` - –∫–æ–≥–¥–∞ –≤–æ–∑–º–æ–∂–Ω—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- `get_or_create()` - –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç, –µ—Å–ª–∏ –æ–Ω –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

## –ú–µ—Ç–æ–¥ `get_or_create` üîÑ

–ú–µ—Ç–æ–¥ `get_or_create` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ, –µ—Å–ª–∏ –æ–±—ä–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω. –û–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ç–µ–∂, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –æ–±—ä–µ–∫—Ç –∏ –±—É–ª–µ–≤–æ –∑–Ω–∞—á–µ–Ω–∏–µ, —É–∫–∞–∑—ã–≤–∞—é—â–µ–µ, –±—ã–ª –ª–∏ –æ–±—ä–µ–∫—Ç —Å–æ–∑–¥–∞–Ω.

```python
master_g, created = Master.objects.get_or_create(first_name="–ì–µ–Ω–¥–∞–ª—å—Ñ", last_name="–ë–µ–ª—ã–π")
```

–í –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –º—ã —Å–æ–∑–¥–∞–¥–∏–º –ì–µ–Ω–¥–∞–ª—å—Ñ–∞ –ë–µ–ª–æ–≥–æ. –í–æ –≤—Ç–æ—Ä–æ–π —Ä–∞–∑ - –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—É—á–∏–º –µ–≥–æ. –ü–æ—ç—Ç–æ–º—É `created` –±—É–¥–µ—Ç `True` –∏–ª–∏ `False`.


## –ú–µ—Ç–æ–¥ `Filter` üéØ

–ú–µ—Ç–æ–¥ `filter()` - –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ Django ORM. –û–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç QuerySet –æ–±—ä–µ–∫—Ç–æ–≤, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–¥–∞–Ω–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
1. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç QuerySet (–º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å 0, 1 –∏–ª–∏ –º–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤)
2. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ü–µ–ø–æ—á–µ—á–Ω—ã–π –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–æ–≤
3. –õ–µ–Ω–∏–≤–∞—è –æ—Ü–µ–Ω–∫–∞ - –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
4. –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ç—Ä–æ–∏—Ç—å —Å–ª–æ–∂–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –≤—ã–±–æ—Ä–∫–∏

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

#### –ë–∞–∑–æ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã:
```python
# –ü—Ä–æ—Å—Ç–æ–µ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ
masters = Master.objects.filter(first_name="–ì–µ–Ω–¥–∞–ª—å—Ñ")

# –ù–µ—Å–∫–æ–ª—å–∫–æ —É—Å–ª–æ–≤–∏–π (AND)
masters = Master.objects.filter(
    first_name="–ì–µ–Ω–¥–∞–ª—å—Ñ",
    last_name="–°–µ—Ä—ã–π"
)

# –ò—Å–∫–ª—é—á–µ–Ω–∏–µ (NOT)
masters = Master.objects.exclude(last_name="–ë–µ–ª—ã–π")

# –°—Ä–∞–≤–Ω–µ–Ω–∏—è
orders = Order.objects.filter(created_at__gte=timezone.now() - timedelta(days=7))
```

#### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–≤—è–∑–∞–Ω–Ω—ã–º –æ–±—ä–µ–∫—Ç–∞–º:
```python
# –ü–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–∞—Å—Ç–µ—Ä–∞
orders = Order.objects.filter(master=master)

# –ü–æ–ª—É—á–∏—Ç—å –º–∞—Å—Ç–µ—Ä–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –∑–∞–∫–∞–∑—ã
masters = Master.objects.filter(orders__isnull=False)

# –§–∏–ª—å—Ç—Ä –ø–æ –ø–æ–ª—è–º —Å–≤—è–∑–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
orders = Order.objects.filter(master__first_name="–ì–µ–Ω–¥–∞–ª—å—Ñ")
```

#### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã:
```python
# –°–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–¥—Å—Ç—Ä–æ–∫—É (—Ä–µ–≥–∏—Å—Ç—Ä–æ–∑–∞–≤–∏—Å–∏–º–æ)
orders = Order.objects.filter(comment__contains="–±–æ—Ä–æ–¥")

# –°–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–¥—Å—Ç—Ä–æ–∫—É (—Ä–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ)
orders = Order.objects.filter(comment__icontains="–±–æ—Ä–æ–¥")

# –í—Ö–æ–∂–¥–µ–Ω–∏–µ –≤ —Å–ø–∏—Å–æ–∫
masters = Master.objects.filter(first_name__in=["–ì–µ–Ω–¥–∞–ª—å—Ñ", "–°–∞—Ä—É–º–∞–Ω"])

# –î–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç
from datetime import datetime, timedelta
week_ago = datetime.now() - timedelta(days=7)
orders = Order.objects.filter(created_at__range=(week_ago, datetime.now()))
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤:
1. `select_related()` - –¥–ª—è ForeignKey (–æ–¥–∏–Ω-–∫–æ-–º–Ω–æ–≥–∏–º)
```python
orders = Order.objects.select_related('master').all()
```

2. `prefetch_related()` - –¥–ª—è ManyToMany –∏ –æ–±—Ä–∞—Ç–Ω—ã—Ö —Å–≤—è–∑–µ–π
```python
masters = Master.objects.prefetch_related('orders').all()
```

3. `only()`/`defer()` - –≤—ã–±–æ—Ä —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã—Ö –ø–æ–ª–µ–π
```python
masters = Master.objects.only('first_name', 'last_name')
```

### –¶–µ–ø–æ—á–∫–∏ –º–µ—Ç–æ–¥–æ–≤:
```python
# –ü—Ä–∏–º–µ—Ä —Å–ª–æ–∂–Ω–æ–π —Ü–µ–ø–æ—á–∫–∏
recent_orders = (Order.objects
                 .filter(master=master)
                 .exclude(status='canceled')
                 .order_by('-created_at')
                 .select_related('master')
                 [:10])
```

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å filter():
- –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç–æ–≤
- –î–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π –≤—ã–±–æ—Ä–∫–∏
- –î–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —á–∞—Å—Ç–∏—á–Ω—ã–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è–º
- –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏ –∑–Ω–∞—á–µ–Ω–∏–π

## QuerySet - —á—Ç–æ —ç—Ç–æ –∏ –∫–∞–∫ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç? üß†

–¢–µ–æ—Ä–∏—è –ø–æ `QuerySet` –≤ Django:

### –ß—Ç–æ —Ç–∞–∫–æ–µ `QuerySet`?

`QuerySet` –≤ Django ‚Äî —ç—Ç–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –∏–∑ –≤–∞—à–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ —ç—Ç–æ –∏—Ç–µ—Ä–∞—Ç–æ—Ä.

–≠—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤, –∞ –º–æ—â–Ω—ã–π –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–∞–±–æ—Ä –∑–∞–ø–∏—Å–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –î—É–º–∞–π—Ç–µ –æ `QuerySet` –∫–∞–∫ –æ "—Å—Ç—Ä–æ–∏—Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–æ–≤" –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ö–æ–≥–¥–∞ –≤—ã —Å–æ–∑–¥–∞–µ—Ç–µ `QuerySet`, Django –µ—â–µ –Ω–µ –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö; –æ–Ω –ø—Ä–æ—Å—Ç–æ —Å—Ç—Ä–æ–∏—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–∞.

–ù–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –≤—ã –ø–∏—à–µ—Ç–µ `Master.objects.all()`, –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ `QuerySet`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç "–≤—Å–µ—Ö –º–∞—Å—Ç–µ—Ä–æ–≤". –ö–æ–≥–¥–∞ –≤—ã –¥–æ–±–∞–≤–ª—è–µ—Ç–µ `filter()`, –Ω–∞–ø—Ä–∏–º–µ—Ä `Master.objects.filter(first_name="–ì–µ–Ω–¥–∞–ª—å—Ñ")`, –≤—ã —É—Ç–æ—á–Ω—è–µ—Ç–µ —ç—Ç–æ—Ç `QuerySet`, —á—Ç–æ–±—ã –æ–Ω –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–ª "–≤—Å–µ—Ö –º–∞—Å—Ç–µ—Ä–æ–≤ —Å –∏–º–µ–Ω–µ–º –ì–µ–Ω–¥–∞–ª—å—Ñ".

### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω `QuerySet`?

`QuerySet` –Ω—É–∂–µ–Ω –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∫–ª—é—á–µ–≤—ã–º –ø—Ä–∏—á–∏–Ω–∞–º:

1.  **–ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –æ—Ç SQL:** –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—è Python-–∫–æ–¥, –∞ –Ω–µ –ø–∏—Å–∞—Ç—å —Å—ã—Ä—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–º, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º –∏ –º–µ–Ω–µ–µ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–Ω—ã–º –æ—à–∏–±–∫–∞–º, —Å–≤—è–∑–∞–Ω–Ω—ã–º —Å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º SQL –∏–ª–∏ —Ä–∞–∑–ª–∏—á–∏—è–º–∏ –º–µ–∂–¥—É –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.
2.  **–õ–µ–Ω–∏–≤–∞—è –æ—Ü–µ–Ω–∫–∞ (Lazy Evaluation):** –≠—Ç–æ –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö –≤–∞–∂–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π `QuerySet`. –ö–∞–∫ —É–ø–æ–º–∏–Ω–∞–ª–æ—Å—å —Ä–∞–Ω–µ–µ, `QuerySet` –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ. –ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω—É–∂–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –≤—ã –Ω–∞—á–∏–Ω–∞–µ—Ç–µ –∏—Ç–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ `QuerySet`, –æ–±—Ä–∞—â–∞–µ—Ç–µ—Å—å –∫ –µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞–º –ø–æ –∏–Ω–¥–µ–∫—Å—É, –∏–ª–∏ –≤—ã–∑—ã–≤–∞–µ—Ç–µ –º–µ—Ç–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫–∏–µ –∫–∞–∫ `list()`, `count()`, `get()`). –≠—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Ç–∞–∫ –∫–∞–∫ Django –º–æ–∂–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã, –æ–±—ä–µ–¥–∏–Ω—è—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–π –≤ –æ–¥–∏–Ω SQL-–∑–∞–ø—Ä–æ—Å.
3.  **–¶–µ–ø–æ—á–µ—á–Ω—ã–π —Å—Ç–∏–ª—å (Chaining):** –ú–µ—Ç–æ–¥—ã `QuerySet` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –Ω–æ–≤—ã–π `QuerySet`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–º "—Ü–µ–ø–æ—á–µ—á–Ω–æ" –≤—ã–∑—ã–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –æ—á–µ–Ω—å –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω—ã–º –∏ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–º. –ù–∞–ø—Ä–∏–º–µ—Ä, `Master.objects.filter(...).order_by(...).count()`.
4.  **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ `QuerySet` –±—ã–ª –æ—Ü–µ–Ω–µ–Ω (—Ç–æ –µ—Å—Ç—å, –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω –∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã), —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –µ—Å–ª–∏ –≤—ã —Å–Ω–æ–≤–∞ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ç–æ–º—É –∂–µ `QuerySet`, Django –Ω–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–≤—Ç–æ—Ä–Ω–æ, –∞ –≤–µ—Ä–Ω–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫—ç—à–∞, —á—Ç–æ –µ—â–µ –±–æ–ª—å—à–µ —É–ª—É—á—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

### –ß—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∞—Ç—å `QuerySet`?

`QuerySet` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —à–∏—Ä–æ–∫–∏–π –Ω–∞–±–æ—Ä –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –¥–∞–Ω–Ω—ã–º–∏:

1.  **–í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
    *   `all()`: –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –º–æ–¥–µ–ª–∏.
    *   `filter()`: –í—ã–±—Ä–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º.
    *   `exclude()`: –í—ã–±—Ä–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã, *–Ω–µ* —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º.
    *   `get()`: –ü–æ–ª—É—á–∏—Ç—å –æ–¥–∏–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ–±—ä–µ–∫—Ç (–≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ 0 –∏–ª–∏ >1 –æ–±—ä–µ–∫—Ç–æ–≤).
    *   `first()`, `last()`: –ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–π –∏–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –æ–±—ä–µ–∫—Ç –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º `QuerySet`.

2.  **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
    *   `order_by()`: –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –æ–¥–Ω–æ–º—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ–ª—è–º.

3.  **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (—Å—Ä–µ–∑):**
    *   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ä–µ–∑–æ–≤ Python (–Ω–∞–ø—Ä–∏–º–µ—Ä, `[0:10]`) –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç SQL-–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º `LIMIT` –∏ `OFFSET`.

4.  **–°–æ–∑–¥–∞–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
    *   `create()`: –°–æ–∑–¥–∞—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
    *   `update()`: –ú–∞—Å—Å–æ–≤–æ –æ–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—è –¥–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤ `QuerySet`.
    *   `delete()`: –ú–∞—Å—Å–æ–≤–æ —É–¥–∞–ª–∏—Ç—å –æ–±—ä–µ–∫—Ç—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

5.  **–ü–æ–¥—Å—á–µ—Ç:**
    *   `count()`: –ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ `QuerySet`.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, `QuerySet` —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º Django ORM, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –≥–∏–±–∫–∏–π, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –∏ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.

## –ü—Ä–∞–∫—Ç–∏–∫–∞ c ORM üèãÔ∏è

```python
# –ü–æ–ª—É—á–∏—Ç—å –í–°–ï–• –º–∞—Å—Ç–µ—Ä–æ–≤
masters = Master.objects.all()
[master.first_name for master in masters]

# –ü–µ—Ä–≤—ã–π –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
# first_master = Master.objects.first()
first_master = masters[0]

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ .exists()
Master.objects.filter(first_name='–°–∞—É—Ä–æ–Ω').exists()
>>> False
```

## –†–∞–±–æ—Ç–∞ —Å–æ —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ ü§ù

–í Django ORM —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—á–µ–Ω—å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ. –ú—ã –ø—Ä–æ—Å—Ç–æ –æ–±—Ä–∞—â–∞–µ–º—Å—è –∫ –ø–æ–ª—é, –∫–æ—Ç–æ—Ä–æ–µ —è–≤–ª—è–µ—Ç—Å—è ForeignKey.

```python
# –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–∫–∞–∑—ã
orders = Order.objects.all()

# –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫–∞–∑
last_order = orders.last()

# –ü–æ–ª—É—á–∏—Ç—å –µ–≥–æ –º–∞—Å—Ç–µ—Ä–∞
last_order.master
```

–í –æ–±—Ä–∞—Ç–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫ –∂–µ –ø—Ä–æ—Å—Ç–æ. –ú—ã –æ–±—Ä–∞—â–∞–µ–º—Å—è –∫ –ø–æ–ª—é, –∫–æ—Ç–æ—Ä–æ–µ —è–≤–ª—è–µ—Ç—Å—è `related_name` –≤ –º–æ–¥–µ–ª–∏ `Master`.

```python
all_masters = Master.objects.all()
all_masters.count() # 3
# –ë–µ—Ä–µ–º –ø–µ—Ä–≤–æ–≥–æ

first_master = all_masters.first()
first_master.orders
# <django.db.models.fields.related_descriptors.create_reverse_many_to_one_manager.<locals>.RelatedManager object at 0x0000025476295A90>
first_master.orders.all()

# –ê –∫–∞–∫ –±—ã –æ–Ω–æ –±—ã–ª–æ, –µ—Å–ª–∏ –±—ã –º—ã –Ω–µ –¥–∞–ª–∏ related_name –≤ Order
first_masters_orders = Order.objects.filter(master=first_master).all()
first_masters_orders = Order.objects.filter(master__id=1).all()
```

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ `Update` –∏ `Save` üîÑ

### –°–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤—É—é –∑–∞—è–≤–∫—É üìù

```python
new_order = Order(name="–ì–æ—Ä–ª—É–º", phone="1234567890", comment="–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞", master=first_master)
new_order.save()
```

### –û–±–Ω–æ–≤–∏–º –∑–∞—è–≤–∫—É —á–µ—Ä–µ–∑ `save` üíæ

```python
new_order.name = "–°–º–∏—Ä–≥–æ–ª"
new_order.save()
```


### –û–±–Ω–æ–≤–∏–º –∑–∞—è–≤–∫—É —á–µ—Ä–µ–∑ `update` üîÑ
```python
# new_order.update(name="–ì–æ—Ä–ª—É–º", comment="–ú–Ω–µ –Ω—É–∂–Ω–∞ —É—Å–ª—É–≥–∞ –ø–æ–ª–∏—Ä–æ–≤–∫–∏ –∑–æ–ª–æ—Ç–æ–≥–æ –∫–æ–ª—å—Ü–∞!")
Order.objects.filter(name="–°–º–∏—Ä–≥–æ–ª").update(name="–ì–æ—Ä–ª—É–º", comment="–ú–Ω–µ –Ω—É–∂–Ω–∞ —É—Å–ª—É–≥–∞ –ø–æ–ª–∏—Ä–æ–≤–∫–∏ –∑–æ–ª–æ—Ç–æ–≥–æ –∫–æ–ª—å—Ü–∞!")

```

## –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ `delete` üóëÔ∏è

–ú–µ—Ç–æ–¥ `delete()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –û–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω –∫–∞–∫ –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞, —Ç–∞–∫ –∏ –¥–ª—è –≤—Å–µ–≥–æ QuerySet.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã —É–¥–∞–ª–µ–Ω–∏—è:

1. **–£–¥–∞–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞**:
```python
order = Order.objects.get(pk=1)
order.delete()  # —É–¥–∞–ª—è–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ–±—ä–µ–∫—Ç
```

2. **–ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ QuerySet**:
```python
# –£–¥–∞–ª—è–µ–º –≤—Å–µ –∑–∞–∫–∞–∑—ã –ì–æ—Ä–ª—É–º–∞
Order.objects.filter(name="–ì–æ—Ä–ª—É–º").delete()
```

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ delete():

1. –í—ã–∑—ã–≤–∞—é—Ç—Å—è —Å–∏–≥–Ω–∞–ª—ã `pre_delete` –∏ `post_delete`
2. –£–¥–∞–ª—è—é—Ç—Å—è —Å–≤—è–∑–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `on_delete` –≤ ForeignKey
3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–æ—Ä—Ç–µ–∂ `(–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—É–¥–∞–ª–µ–Ω–Ω—ã—Ö_–æ–±—ä–µ–∫—Ç–æ–≤, —Å–ª–æ–≤–∞—Ä—å_–ø–æ_—Ç–∏–ø–∞–º_–æ–±—ä–µ–∫—Ç–æ–≤)`

### –ü—Ä–∏–º–µ—Ä —Å –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º:
```python
deleted = Order.objects.filter(priority__lt=3).delete()
print(deleted)
# (5, {'core.Order': 5}) - —É–¥–∞–ª–µ–Ω–æ 5 –æ–±—ä–µ–∫—Ç–æ–≤ Order
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ QuerySet –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º:
```python
orders = Order.objects.filter(name="–ì–æ—Ä–ª—É–º")
if orders.exists():  # –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –æ–±—ä–µ–∫—Ç–æ–≤
    orders.delete()
```

2. **–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ**: –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `on_delete` –≤ —Å–≤—è–∑—è—Ö:
- `CASCADE` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - —É–¥–∞–ª–∏—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã
- `PROTECT` - –∑–∞–ø—Ä–µ—Ç–∏—Ç —É–¥–∞–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ –µ—Å—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã
- `SET_NULL` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç NULL –≤ —Å–≤—è–∑—è—Ö
- `SET_DEFAULT` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

3. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã**:
- `queryset.update(is_active=False)` - "–º—è–≥–∫–æ–µ" —É–¥–∞–ª–µ–Ω–∏–µ
- –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ `delete()` –≤ –º–æ–¥–µ–ª–∏ –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–π –ª–æ–≥–∏–∫–∏

4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –î–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ QuerySet.delete() –≤–º–µ—Å—Ç–æ —Ü–∏–∫–ª–∞:
```python
# –ü–ª–æ—Ö–æ (N+1 –∑–∞–ø—Ä–æ—Å–æ–≤):
for order in Order.objects.filter(...):
    order.delete()

# –•–æ—Ä–æ—à–æ (1 –∑–∞–ø—Ä–æ—Å):
Order.objects.filter(...).delete()
```

### –ü—Ä–∏–º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è:
```python
try:
    # –£–¥–∞–ª—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω –ø–æ–¥—Ö–æ–¥—è—â–∏–π –∑–∞–∫–∞–∑
    order = Order.objects.get(name="–ì–æ—Ä–ª—É–º", phone="1234567890")
    order.delete()
except Order.DoesNotExist:
    print("–ó–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω")
except Order.MultipleObjectsReturned:
    print("–ù–∞–π–¥–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–∫–∞–∑–æ–≤ - –Ω—É–∂–µ–Ω –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä")
```