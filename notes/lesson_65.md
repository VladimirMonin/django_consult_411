# –£—Ä–æ–∫ 62: –ú–∞–≥–∏—è Django Class-Based Views (CBV)

Django Class-Based Views (CBV) ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–∏—Å–∞—Ç—å –±–æ–ª–µ–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–π –∫–æ–¥ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–µ–±-–∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–º–∏ Function-Based Views (FBV). –û–Ω–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –Ω–∞–±–æ—Ä –≥–æ—Ç–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å, –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä—è—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –∏ —É–ª—É—á—à–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞.

```mermaid
flowchart LR
    %% –ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã
    View["üèõÔ∏è View<br/><small>–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –≤—Å–µ—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π</small>"]
    TemplateView["üé® TemplateView<br/><small>–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞</small>"]
    RedirectView["üîÑ RedirectView<br/><small>–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</small>"]
    
    %% Generic Views
    GenericView["‚öôÔ∏è GenericView<br/><small>–ë–∞–∑–æ–≤—ã–π Generic View</small>"]
    
    %% Display Views
    DetailView["üîç DetailView<br/><small>–î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –æ–±—ä–µ–∫—Ç–∞</small>"]
    ListView["üìã ListView<br/><small>–°–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤</small>"]
    
    %% Edit Views
    FormView["üìù FormView<br/><small>–†–∞–±–æ—Ç–∞ —Å —Ñ–æ—Ä–º–∞–º–∏</small>"]
    CreateView["‚ûï CreateView<br/><small>–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞</small>"]
    UpdateView["‚úèÔ∏è UpdateView<br/><small>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞</small>"]
    DeleteView["üóëÔ∏è DeleteView<br/><small>–£–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞</small>"]
    
    %% Date Views
    ArchiveIndexView["üìÖ ArchiveIndexView<br/><small>–ê—Ä—Ö–∏–≤–Ω—ã–π –∏–Ω–¥–µ–∫—Å</small>"]
    YearArchiveView["üìÜ YearArchiveView<br/><small>–ê—Ä—Ö–∏–≤ –ø–æ –≥–æ–¥–∞–º</small>"]
    MonthArchiveView["üóìÔ∏è MonthArchiveView<br/><small>–ê—Ä—Ö–∏–≤ –ø–æ –º–µ—Å—è—Ü–∞–º</small>"]
    WeekArchiveView["üìä WeekArchiveView<br/><small>–ê—Ä—Ö–∏–≤ –ø–æ –Ω–µ–¥–µ–ª—è–º</small>"]
    DayArchiveView["üìã DayArchiveView<br/><small>–ê—Ä—Ö–∏–≤ –ø–æ –¥–Ω—è–º</small>"]
    TodayArchiveView["‚è∞ TodayArchiveView<br/><small>–°–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –∞—Ä—Ö–∏–≤</small>"]
    DateDetailView["üîç DateDetailView<br/><small>–î–µ—Ç–∞–ª–∏ –ø–æ –¥–∞—Ç–µ</small>"]
    
    %% –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
    View --> TemplateView
    View --> RedirectView
    View --> GenericView
    
    GenericView --> DetailView
    GenericView --> ListView
    GenericView --> FormView
    
    FormView --> CreateView
    FormView --> UpdateView
    FormView --> DeleteView
    
    ListView --> ArchiveIndexView
    ListView --> YearArchiveView
    ListView --> MonthArchiveView
    ListView --> WeekArchiveView
    ListView --> DayArchiveView
    ListView --> TodayArchiveView
    
    DetailView --> DateDetailView
    
    %% –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è
    classDef baseClass fill:#e1f5fe,stroke:#01579b,stroke-width:3px,color:#000
    classDef templateClass fill:#f3e5f5,stroke:#4a148c,stroke-width:2px,color:#000
    classDef listClass fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px,color:#000
    classDef formClass fill:#fff3e0,stroke:#e65100,stroke-width:2px,color:#000
    classDef dateClass fill:#fce4ec,stroke:#880e4f,stroke-width:2px,color:#000
    
    class View baseClass
    class TemplateView,RedirectView templateClass
    class GenericView,DetailView,ListView listClass
    class FormView,CreateView,UpdateView,DeleteView formClass
    class ArchiveIndexView,YearArchiveView,MonthArchiveView,WeekArchiveView,DayArchiveView,TodayArchiveView,DateDetailView dateClass
```
> **–ü–æ—è—Å–Ω–µ–Ω–∏–µ –∫ –¥–∏–∞–≥—Ä–∞–º–º–µ:**
> *  **`View`**: –°–∞–º—ã–π –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å. –û—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –º–µ—Ç–æ–¥–∞–º (`get`, `post` –∏ —Ç.–¥.).
> *  **Mixins**: –ö–ª–∞—Å—Å—ã-–ø—Ä–∏–º–µ—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–±–∞–≤–ª—è—é—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.
>    *   `TemplateResponseMixin`: –î–æ–±–∞–≤–ª—è–µ—Ç –ª–æ–≥–∏–∫—É –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —à–∞–±–ª–æ–Ω–æ–≤.
>    *   `ContextMixin`: –î–æ–±–∞–≤–ª—è–µ—Ç –ª–æ–≥–∏–∫—É –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö (–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞) –≤ —à–∞–±–ª–æ–Ω.
>    *   `SingleObjectMixin`: –î–æ–±–∞–≤–ª—è–µ—Ç –ª–æ–≥–∏–∫—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –º–æ–¥–µ–ª–∏ (`.get()`).
>    *   `MultipleObjectMixin`: –î–æ–±–∞–≤–ª—èa–µ—Ç –ª–æ–≥–∏–∫—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤ (`.all()`, `.filter()`).
> *  **Generic Views**: –ì–æ—Ç–æ–≤—ã–µ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∫–ª–∞—Å—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –∫–æ–º–±–∏–Ω–∏—Ä—É—é—Ç `View` –∏ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–∏–∫—Å–∏–Ω—ã –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —Ç–∏–ø–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á (–ø–æ–∫–∞–∑ —à–∞–±–ª–æ–Ω–∞, –æ–±—ä–µ–∫—Ç–∞, —Å–ø–∏—Å–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤).

## 1. –ë–∞–∑–æ–≤–∞—è View (`django.views.View`)

–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å `View` —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–æ–π –¥–ª—è –≤—Å–µ—Ö Class-Based Views –≤ Django. –û–Ω –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∏–∫–∞–∫–æ–π —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏, –∫—Ä–æ–º–µ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏–∏ HTTP-–º–µ—Ç–æ–¥–æ–≤. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Ç–æ–¥—ã —Å –∏–º–µ–Ω–∞–º–∏ HTTP-–≥–ª–∞–≥–æ–ª–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `get()`, `post()`, `put()`, `delete()`), –∏ Django –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑–æ–≤–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –≤—Ö–æ–¥—è—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.

### –ú–µ—Ç–æ–¥—ã

*   **`get(self, request, *args, **kwargs)`**: –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ GET-–∑–∞–ø—Ä–æ—Å–∞.
*   **`post(self, request, *args, **kwargs)`**: –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ POST-–∑–∞–ø—Ä–æ—Å–∞.
*   **`put(self, request, *args, **kwargs)`**: –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ PUT-–∑–∞–ø—Ä–æ—Å–∞.
*   **`delete(self, request, *args, **kwargs)`**: –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ DELETE-–∑–∞–ø—Ä–æ—Å–∞.
*   **`dispatch(self, request, *args, **kwargs)`**: –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–π –∑–∞–ø—Ä–æ—Å. –û–Ω –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø HTTP-–º–µ—Ç–æ–¥–∞ –∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ (`get`, `post` –∏ —Ç.–¥.). –í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å `dispatch` –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç HTTP-–º–µ—Ç–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π).

### Args –∏ kwargs

`*args` –∏ `**kwargs` –≤ –º–µ—Ç–æ–¥–∞—Ö CBV (`get`, `post` –∏ —Ç.–¥.) –ø–æ–ª—É—á–∞—é—Ç —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö –≤ URL-—à–∞–±–ª–æ–Ω–µ (`urls.py`). –í –ø–æ–¥–∞–≤–ª—è—é—â–µ–º –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –≤—ã –±—É–¥–µ—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å `**kwargs`, —Ç–∞–∫ –∫–∞–∫ Django –ø–µ—Ä–µ–¥–∞–µ—Ç –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã–µ –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–∫ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã.

–í–æ—Ç —Ç–∞–±–ª–∏—Ü–∞ —Å –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `**kwargs`:

| –ê—Ä–≥—É–º–µ–Ω—Ç | –û—Ç–∫—É–¥–∞ –±–µ—Ä–µ—Ç—Å—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä URL-—à–∞–±–ª–æ–Ω–∞ | –ü—Ä–∏–º–µ—Ä `kwargs` –≤ View |
| :--- | :--- | :--- | :--- | :--- |
| `pk` | –ò–∑ URL | **P**rimary **K**ey (–ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á) –æ–±—ä–µ–∫—Ç–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ `DetailView` –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –≤ –ë–î. | `path('item/<int:pk>/', ...)` | `{'pk': 123}` |
| `slug` | –ò–∑ URL | "–°–ª–∞–≥" –æ–±—ä–µ–∫—Ç–∞ ‚Äî —á–µ–ª–æ–≤–µ–∫–æ-–ø–æ–Ω—è—Ç–Ω–∞—è —á–∞—Å—Ç—å URL. –¢–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `DetailView` –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ `pk`. | `path('post/<slug:slug>/', ...)` | `{'slug': 'my-first-post'}` |
| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã | –ò–∑ URL | –õ—é–±—ã–µ –¥—Ä—É–≥–∏–µ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç–µ –≤ —Å–≤–æ–µ–º URL-—à–∞–±–ª–æ–Ω–µ. | `path('archive/<int:year>/<str:month>/', ...)` | `{'year': 2024, 'month': 'july'}` |

`*args` (–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã) –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≥–æ—Ä–∞–∑–¥–æ —Ä–µ–∂–µ, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å–æ —Å—Ç–∞—Ä—ã–º–∏ URL-—à–∞–±–ª–æ–Ω–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–º–∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø. –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ Django ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.


### –ö–æ–≥–¥–∞ –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–∞?

–ë–∞–∑–æ–≤–∞—è `View` –ø–æ–ª–µ–∑–Ω–∞, –∫–æ–≥–¥–∞ –≤–∞–º –Ω—É–∂–Ω–∞ –ø–æ–ª–Ω–∞—è –≥–∏–±–∫–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∑–∞–ø—Ä–æ—Å–æ–≤, –∏ –≤—ã –Ω–µ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ CBV. –û–Ω–∞ –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:

*   –°–æ–∑–¥–∞–Ω–∏—è API-—ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤, –≥–¥–µ –ª–æ–≥–∏–∫–∞ —Å–∏–ª—å–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç HTTP-–º–µ—Ç–æ–¥–∞.
*   –û–±—Ä–∞–±–æ—Ç–∫–∏ —Å–ª–æ–∂–Ω—ã—Ö —Ñ–æ—Ä–º, —Ç—Ä–µ–±—É—é—â–∏—Ö —Ä–∞–∑–ª–∏—á–Ω–æ–π –ª–æ–≥–∏–∫–∏ –¥–ª—è GET –∏ POST.
*   –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤.

### –ü—Ä–∏–º–µ—Ä –∏–∑ –∫–æ–¥–∞ (`core/views.py`)

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º `GreetingView`:

```python
# core/views.py
from django.views import View
from django.http import HttpResponse

class GreetingView(View):
    """
    –ü—Ä–æ—Å—Ç–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞ View.
    –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É GET –∏ POST –∑–∞–ø—Ä–æ—Å–æ–≤.
    """
    greeting_get_message = "–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä! –≠—Ç–æ GET –∑–∞–ø—Ä–æ—Å –∏–∑ GreetingView."
    greeting_post_message = "–í—ã —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ POST –∑–∞–ø—Ä–æ—Å –≤ GreetingView!"

    def get(self, request, *args, **kwargs):
        """
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç GET-–∑–∞–ø—Ä–æ—Å—ã.
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–µ HTTP-—Å–æ–æ–±—â–µ–Ω–∏–µ.
        """
        return HttpResponse(self.greeting_get_message)

    def post(self, request, *args, **kwargs):
        """
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç POST-–∑–∞–ø—Ä–æ—Å—ã.
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–µ HTTP-—Å–æ–æ–±—â–µ–Ω–∏–µ.
        """
        return HttpResponse(self.greeting_post_message)
```

#TODO - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, —á—Ç–æ –∫–ª–∞—Å—Å–æ–≤–∞—è –≤—å—é –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ –∑–∞–ø—Ä–æ—Å—ã, –º–µ—Ç–æ–¥—ã –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥—É—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã. –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –æ–Ω–∞ —Å–∞–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ—à–∏–±–∫—É 405.


–í `core/urls.py` —ç—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–≤—è–∑–∞–Ω–æ —Ç–∞–∫:

```python
# core/urls.py
from django.urls import path
from .views import GreetingView

urlpatterns = [
    path("greeting/", GreetingView.as_view(), name="greeting"),
]
```

–ú–µ—Ç–æ–¥ `.as_view()` –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∫–ª–∞—Å—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤ –≤—ã–∑—ã–≤–∞–µ–º—É—é —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é Django –æ–∂–∏–¥–∞–µ—Ç –¥–ª—è URL-–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏.



## 2. TemplateView (`django.views.generic.TemplateView`)

`TemplateView` ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π CBV, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –∏–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏ –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. –≠—Ç–æ –æ—Ç–ª–∏—á–Ω–∞—è –∑–∞–º–µ–Ω–∞ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö Function-Based Views, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Å—Ç–æ —Ä–µ–Ω–¥–µ—Ä—è—Ç —à–∞–±–ª–æ–Ω.

### –ê—Ç—Ä–∏–±—É—Ç—ã

*   **`template_name`**: **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π** –∞—Ç—Ä–∏–±—É—Ç, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –∏–º—è —à–∞–±–ª–æ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω.
*   **`extra_context`**: –°–ª–æ–≤–∞—Ä—å, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç —à–∞–±–ª–æ–Ω–∞.

### –†–∞—Å—à–∏—Ä—è–µ–º—ã–µ –º–µ—Ç–æ–¥—ã

*   **`get_context_data(self, **kwargs)`**: –ú–µ—Ç–æ–¥ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ —à–∞–±–ª–æ–Ω. –û–Ω –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–ª–æ–≤–∞—Ä—å. –í–∞–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å `super().get_context_data(**kwargs)`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞.
*   **`get_template_names(self)`**: –ü–æ–∑–≤–æ–ª—è–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –∏–º—è —à–∞–±–ª–æ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª–æ–≥–∏–∫–∏. –ï—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `template_name`.
*   **`dispatch(self, request, *args, **kwargs)`**: –ö–∞–∫ –∏ –≤ –±–∞–∑–æ–≤–æ–π `View`, –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –¥–æ –≤—ã–∑–æ–≤–∞ `get()` (–∏–ª–∏ –¥—Ä—É–≥–∏—Ö –º–µ—Ç–æ–¥–æ–≤ HTTP).

### –ö–æ–≥–¥–∞ –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–∞?

*   –î–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü "–û –Ω–∞—Å", "–ö–æ–Ω—Ç–∞–∫—Ç—ã", "–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏" –∏ –¥—Ä—É–≥–∏—Ö —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü.
*   –î–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü, –≥–¥–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ—Å—Ç—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏–ª–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î.

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∫–æ–¥–∞ (`core/views.py`)

#### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π `TemplateView` (`SimplePageView`)

```python
# core/views.py
from django.views.generic import TemplateView

class SimplePageView(TemplateView):
    """
    –ü—Ä–æ—Å—Ç–µ–π—à–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞—Ç—Ä–∏–±—É—Ç template_name –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–∞.
    """
    template_name = "core/simple_page.html"
```

–í `core/urls.py`:

```python
# core/urls.py
from django.urls import path
from .views import SimplePageView

urlpatterns = [
    path("simple-page/", SimplePageView.as_view(), name="simple_page"),
]
```

–≠—Ç–æ "View –≤ 2 —Å—Ç—Ä–æ–∫–∏", —Ç–∞–∫ –∫–∞–∫ –≤—Å–µ, —á—Ç–æ –Ω—É–∂–Ω–æ, —ç—Ç–æ —É–∫–∞–∑–∞—Ç—å –∏–º—è —à–∞–±–ª–æ–Ω–∞.

#### –ü—Ä–∏–º–µ—Ä 2: `TemplateView` —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (`AboutUsView`)

```python
# core/views.py
from django.views.generic import TemplateView
import datetime # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º datetime –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

class AboutUsView(TemplateView):
    """
    –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã "–û –Ω–∞—Å".
    –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä–µ–¥–∞—á—É –∫–∞–∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ, —Ç–∞–∫ –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ —à–∞–±–ª–æ–Ω
    —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ get_context_data().
    """
    template_name = "core/about_us.html"

    def get_context_data(self, **kwargs):
        """
        –§–æ—Ä–º–∏—Ä—É–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è —à–∞–±–ª–æ–Ω–∞.
        """
        context = super().get_context_data(**kwargs)
        
        context['company_name'] = "–ë–∞—Ä–±–µ—Ä—à–æ–ø '–ê—Ä–±—É–∑'"
        context['start_year'] = 2010
        context['current_year'] = datetime.date.today().year
        context['years_on_market'] = datetime.date.today().year - context['start_year']
        context['page_title'] = "–û –Ω–∞—Å - –ë–∞—Ä–±–µ—Ä—à–æ–ø '–ê—Ä–±—É–∑'"
        context['contact_email'] = "contact@arbuz-barbershop.com"
        
        return context
```

–í `core/urls.py`:

```python
# core/urls.py
from django.urls import path
from .views import AboutUsView

urlpatterns = [
    path("about-us/", AboutUsView.as_view(), name="about_us"),
]
```

–ó–¥–µ—Å—å `get_context_data` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞–∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö (`company_name`), —Ç–∞–∫ –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö (`years_on_market`) –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç —à–∞–±–ª–æ–Ω–∞.

#### –ü—Ä–∏–º–µ—Ä 3: –ü–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ FBV –Ω–∞ `TemplateView` (`ThanksView`)

–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ `thanks` –º–æ–≥ –±—ã—Ç—å Function-Based View, –Ω–æ –µ–≥–æ –ø–µ—Ä–µ–ø–∏—Å–∞–ª–∏ –Ω–∞ `TemplateView` –¥–ª—è –ª—É—á—à–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏:

```python
# core/views.py
from django.views.generic import TemplateView
from django.db.models import Count # –î–ª—è masters_count
from .models import Master # –î–ª—è masters_count

class ThanksView(TemplateView):
    template_name = "core/thanks.html"

    def get_context_data(self, **kwargs):
        context = super().get_context_data(**kwargs)
        
        masters_count = Master.objects.filter(is_active=True).count()
        context["masters_count"] = masters_count
        context["additional_message"] = "–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –≤—ã–±—Ä–∞–ª–∏ –Ω–∞—à –ø–µ—Ä–≤–æ–∫–ª–∞—Å—Å–Ω—ã–π —Å–µ—Ä–≤–∏—Å!"
        
        if 'source' in kwargs:
            source_page = kwargs['source']
            if source_page == 'order':
                context['source_message'] = "–í–∞—à –∑–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –∏ –ø—Ä–∏–Ω—è—Ç –≤ –æ–±—Ä–∞–±–æ—Ç–∫—É."
            elif source_page == 'review':
                context['source_message'] = "–í–∞—à –æ—Ç–∑—ã–≤ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∏ –±—É–¥–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –ø–æ—Å–ª–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏."
            else:
                context['source_message'] = f"–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –≤–∞—Å –∑–∞ –≤–∞—à–µ –¥–µ–π—Å—Ç–≤–∏–µ, –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã: {source_page}."
        else:
            context['source_message'] = "–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –≤–∞—Å –∑–∞ –ø–æ—Å–µ—â–µ–Ω–∏–µ!"
            
        return context
```

–í `core/urls.py`:

```python
# core/urls.py
from django.urls import path
from .views import ThanksView

urlpatterns = [
    path("thanks/", ThanksView.as_view(), name="thanks"),
    path("thanks/<str:source>/", ThanksView.as_view(), name="thanks_with_source"),
]
```

–ó–¥–µ—Å—å `get_context_data` —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞—Å—Ç–µ—Ä–æ–≤) –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ URL (`source`).

## 3. DetailView (`django.views.generic.DetailView`)

`DetailView` –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ–¥–Ω–æ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –æ–±—ä–µ–∫—Ç–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –û–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –æ–±—ä–µ–∫—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ (PK) –∏–ª–∏ slug, –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ –≤ URL.

### –ê—Ç—Ä–∏–±—É—Ç—ã

*   **`model`**: **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π** –∞—Ç—Ä–∏–±—É—Ç, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –º–æ–¥–µ–ª—å, –∏–∑ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å—Å—è –æ–±—ä–µ–∫—Ç.
*   **`template_name`**: –ò–º—è —à–∞–±–ª–æ–Ω–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ, Django –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—â–µ—Ç —à–∞–±–ª–æ–Ω –ø–æ –ø—É—Ç–∏ `<app_label>/<model_name_lowercase>_detail.html` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `core/order_detail.html`).
*   **`pk_url_kwarg`**: –ò–º—è –∏–º–µ–Ω–æ–≤–∞–Ω–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ URL, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á –æ–±—ä–µ–∫—Ç–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `'pk'`. –ï—Å–ª–∏ –≤ URL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–æ–µ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `order_id`), –µ–≥–æ –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∑–¥–µ—Å—å.
*   **`slug_url_kwarg`**: –ò–º—è –∏–º–µ–Ω–æ–≤–∞–Ω–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ URL, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç slug –æ–±—ä–µ–∫—Ç–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `'slug'`.
*   **`slug_field`**: –ò–º—è –ø–æ–ª—è –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä–æ–µ —Å–æ–¥–µ—Ä–∂–∏—Ç slug. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `'slug'`.
*   **`context_object_name`**: –ò–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –ø–æ–¥ –∫–æ—Ç–æ—Ä–æ–π –æ–±—ä–µ–∫—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —à–∞–±–ª–æ–Ω–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç—Ç–æ –∏–º—è –º–æ–¥–µ–ª–∏ –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `order` –¥–ª—è –º–æ–¥–µ–ª–∏ `Order`).
*   **`extra_context`**: –°–ª–æ–≤–∞—Ä—å —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç.

### –ú–µ—Ç–æ–¥—ã

*   **`get_queryset(self)`**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç QuerySet, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –±—É–¥–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å—Å—è –æ–±—ä–µ–∫—Ç. –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, `select_related` –∏–ª–∏ `prefetch_related` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.
*   **`get_object(self, queryset=None)`**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ–±—ä–µ–∫—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—É—á–∏—Ç—å –µ–≥–æ –Ω–µ –ø–æ PK/slug, –∞ –ø–æ –¥—Ä—É–≥–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º), –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —ç—Ç–æ—Ç –º–µ—Ç–æ–¥.
*   **`get_context_data(self, **kwargs)`**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —à–∞–±–ª–æ–Ω–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –Ω–∞–ø—Ä—è–º—É—é —Å –æ—Å–Ω–æ–≤–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º.

### –ó–∞—â–∏—Ç–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π

#### –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å –æ—Ç –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `LoginRequiredMixin` –∏–∑ `django.contrib.auth.mixins`. –≠—Ç–æ—Ç –º–∏–∫—Å–∏–Ω –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞.

```python
# core/views.py
from django.contrib.auth.mixins import LoginRequiredMixin
from django.views.generic import DetailView
from .models import Order

class OrderDetailView(LoginRequiredMixin, DetailView):
    model = Order
    template_name = "core/order_detail.html"
    pk_url_kwarg = "order_id"  # –£–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ pk –±—É–¥–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å—Å—è –∏–∑ order_id –≤ URL
```

#### –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å –æ—Ç –ù–ï `is_staff`?

–ï—Å—Ç—å –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞:

1.  **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `UserPassesTestMixin`**: –≠—Ç–æ—Ç –º–∏–∫—Å–∏–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Ç–æ–¥ `test_func()`, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `True` –∏–ª–∏ `False`. –ï—Å–ª–∏ `False`, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `handle_no_permission()`.

    ```python
    # core/views.py
    from django.contrib.auth.mixins import UserPassesTestMixin
    from django.shortcuts import redirect
    from django.contrib import messages

    class StaffRequiredMixin(UserPassesTestMixin):
        """
        –ú–∏–∫—Å–∏–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–º (is_staff).
        –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
        —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ–± –æ—à–∏–±–∫–µ.
        """
        def test_func(self):
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–º
            return self.request.user.is_authenticated and self.request.user.is_staff

        def handle_no_permission(self):
            # –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ test_func –≤–µ—Ä–Ω—É–ª False
            messages.error(self.request, "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É —Ä–∞–∑–¥–µ–ª—É.")
            return redirect("landing") # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ 'landing' - —ç—Ç–æ –∏–º—è URL –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    ```

    –ó–∞—Ç–µ–º –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –º–∏–∫—Å–∏–Ω –≤ —Å–≤–æ–∏—Ö CBV:

    ```python
    # core/views.py
    class OrderDetailView(LoginRequiredMixin, StaffRequiredMixin, DetailView):
        model = Order
        template_name = "core/order_detail.html"
        pk_url_kwarg = "order_id"
    ```

2.  **–ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Ç–æ–¥ `dispatch`**: –í—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä—è–º–æ –≤ –º–µ—Ç–æ–¥ `dispatch` –≤–∞—à–µ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è.

    ```python
    # core/views.py
    from django.contrib.auth.mixins import LoginRequiredMixin
    from django.views.generic import DetailView
    from django.shortcuts import redirect
    from django.contrib import messages
    # from django.http import Http403 # –ú–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è Http403
    
    class OrderDetailView(LoginRequiredMixin, DetailView):
        model = Order
        template_name = "core/order_detail.html"
        pk_url_kwarg = "order_id"
    
        def dispatch(self, request, *args, **kwargs):
            # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—ç—Ç–æ –¥–µ–ª–∞–µ—Ç LoginRequiredMixin,
            # –Ω–æ –µ—Å–ª–∏ –±—ã –µ–≥–æ –Ω–µ –±—ã–ª–æ, –ø—Ä–æ–≤–µ—Ä–∫–∞ –±—ã–ª–∞ –±—ã –∑–¥–µ—Å—å: if not request.user.is_authenticated:)
            # –ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–º
            if not request.user.is_staff:
                messages.error(request, "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.")
                return redirect("landing") 
                # –ò–ª–∏ –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –≤—ã–∑–≤–∞—Ç—å Http403: from django.http import Http403; raise Http403("–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω")
            
            # –ï—Å–ª–∏ –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã, –≤—ã–∑—ã–≤–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –º–µ—Ç–æ–¥ dispatch,
            # –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –≤—ã–∑–æ–≤–µ—Ç get(), post() –∏ —Ç.–¥.
            return super().dispatch(request, *args, **kwargs)
    ```

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∫–æ–¥–∞ (`core/views.py`)

#### `OrderDetailView`

```python
# core/views.py
from django.contrib.auth.mixins import LoginRequiredMixin
from django.views.generic import DetailView
from .models import Order
from django.shortcuts import redirect
from django.contrib import messages

class OrderDetailView(LoginRequiredMixin, DetailView):
    model = Order
    template_name = "core/order_detail.html"
    pk_url_kwarg = "order_id"

    def dispatch(self, request, *args, **kwargs):
        if not request.user.is_staff:
            messages.error(request, "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.")
            return redirect("landing") 
        return super().dispatch(request, *args, **kwargs)
```

–í `core/urls.py`:

```python
# core/urls.py
from django.urls import path
from .views import OrderDetailView

urlpatterns = [
    path("orders/<int:order_id>/", OrderDetailView.as_view(), name="order_detail"),
]
```

–ó–¥–µ—Å—å `pk_url_kwarg` —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á –±—É–¥–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å—Å—è –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `order_id` –≤ URL. –ú–µ—Ç–æ–¥ `dispatch` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`is_staff`).

#### `ServiceDetailView`

```python
# core/views.py
from django.views.generic import DetailView
from .models import Service

class ServiceDetailView(DetailView):
    """
    –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å–ª—É–≥–µ.
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥–µ–ª—å Service –∏ —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –∏–º—è —à–∞–±–ª–æ–Ω–∞.
    –í —à–∞–±–ª–æ–Ω –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω –æ–±—ä–µ–∫—Ç service (–∏–º—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π).
    """
    model = Service
    template_name = 'core/service_detail.html'
```

–í `core/urls.py`:

```python
# core/urls.py
from django.urls import path
from .views import ServiceDetailView

urlpatterns = [
    path("service/<int:pk>/", ServiceDetailView.as_view(), name="service_detail"),
]
```

–ó–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∏–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `pk` –≤ URL, –ø–æ—ç—Ç–æ–º—É `pk_url_kwarg` –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

## 4. ListView (`django.views.generic.ListView`)

`ListView` –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è QuerySet, –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

### –ê—Ç—Ä–∏–±—É—Ç—ã

*   **`model`**: **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π** –∞—Ç—Ä–∏–±—É—Ç, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –º–æ–¥–µ–ª—å, –æ–±—ä–µ–∫—Ç—ã –∫–æ—Ç–æ—Ä–æ–π –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è.
*   **`queryset`**: –ú–æ–∂–Ω–æ —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å QuerySet –≤–º–µ—Å—Ç–æ `model`. –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω, `model` –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è.
*   **`template_name`**: –ò–º—è —à–∞–±–ª–æ–Ω–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é Django –∏—â–µ—Ç —à–∞–±–ª–æ–Ω –ø–æ –ø—É—Ç–∏ `<app_label>/<model_name_lowercase>_list.html` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `core/order_list.html`).
*   **`context_object_name`**: –ò–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –ø–æ–¥ –∫–æ—Ç–æ—Ä–æ–π —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —à–∞–±–ª–æ–Ω–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç—Ç–æ `object_list`.
*   **`paginate_by`**: –¶–µ–ª–æ–µ —á–∏—Å–ª–æ, —É–∫–∞–∑—ã–≤–∞—é—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏.
*   **`ordering`**: –°–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫ –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ QuerySet. –ù–∞–ø—Ä–∏–º–µ—Ä, `['name', '-price']`.
*   **`extra_context`**: –°–ª–æ–≤–∞—Ä—å —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç.

### –ú–µ—Ç–æ–¥—ã

*   **`get_queryset(self)`**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç QuerySet –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è. –≠—Ç–æ –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, –ø–æ–∏—Å–∫–∞, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (`select_related`, `prefetch_related`).
*   **`get_context_data(self, **kwargs)`**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —à–∞–±–ª–æ–Ω–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –Ω–∞–ø—Ä—è–º—É—é —Å–æ —Å–ø–∏—Å–∫–æ–º –æ–±—ä–µ–∫—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–≥–æ–ª–æ–≤–∫–∏, —Å—á–µ—Ç—á–∏–∫–∏).

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∫–æ–¥–∞ (`core/views.py`)

#### `ServicesListView`

–≠—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ–Ω—è–µ—Ç Function-Based View `services_list`.

```python
# core/views.py
from django.contrib.auth.mixins import UserPassesTestMixin, LoginRequiredMixin
from django.views.generic import ListView
from .models import Service
from django.shortcuts import redirect
from django.contrib import messages

class StaffRequiredMixin(UserPassesTestMixin):
    def test_func(self):
        return self.request.user.is_authenticated and self.request.user.is_staff

    def handle_no_permission(self):
        messages.error(self.request, "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É —Ä–∞–∑–¥–µ–ª—É.")
        return redirect("landing")

class ServicesListView(StaffRequiredMixin, ListView):
    model = Service
    template_name = "core/services_list.html"
    context_object_name = "services"
    extra_context = {
        "title": "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏",
    }
```

–í `core/urls.py`:

```python
# core/urls.py
from django.urls import path
from .views import ServicesListView

urlpatterns = [
    path("services/", ServicesListView.as_view(), name="services_list"),
]
```

–ó–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `StaffRequiredMixin` –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤. `context_object_name` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `'services'`, —á—Ç–æ–±—ã –≤ —à–∞–±–ª–æ–Ω–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É –∫–∞–∫ `{{ services }}`. `extra_context` –¥–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫.

#### `OrdersListView`

–≠—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ–Ω—è–µ—Ç Function-Based View `orders_list` –∏ –≤–∫–ª—é—á–∞–µ—Ç —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

```python
# core/views.py
from django.contrib.auth.mixins import UserPassesTestMixin, LoginRequiredMixin
from django.views.generic import ListView
from .models import Order, Master, Service # –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –º–æ–¥–µ–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
from django.db.models import Q, F # –î–ª—è Q-–æ–±—ä–µ–∫—Ç–æ–≤ –∏ F-–≤—ã—Ä–∞–∂–µ–Ω–∏–π
from django.shortcuts import redirect
from django.contrib import messages

class StaffRequiredMixin(UserPassesTestMixin):
    def test_func(self):
        return self.request.user.is_authenticated and self.request.user.is_staff

    def handle_no_permission(self):
        messages.error(self.request, "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É —Ä–∞–∑–¥–µ–ª—É.")
        return redirect("landing")

class OrdersListView(StaffRequiredMixin, ListView):
    model = Order
    template_name = "core/orders_list.html"
    context_object_name = "orders"

    def get_queryset(self):
        """
        –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Ç–æ–¥ get_queryset –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤ —Å –∂–∞–¥–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π –º–∞—Å—Ç–µ—Ä–æ–≤ –∏ —É—Å–ª—É–≥.
        –ê —Ç–∞–∫ –∂–µ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –ø–æ–∏—Å–∫–∞.
        """
        all_orders = (
            Order.objects.select_related("master").prefetch_related("services").all()
        )

        search_query = self.request.GET.get("search", None)

        if search_query:
            check_boxes = self.request.GET.getlist("search_in")
            filters = Q()

            if "phone" in check_boxes:
                filters |= Q(phone__icontains=search_query)
            if "name" in check_boxes:
                filters |= Q(client_name__icontains=search_query)
            if "comment" in check_boxes:
                filters |= Q(comment__icontains=search_query)

            if filters:
                all_orders = all_orders.filter(filters)

        return all_orders
```

–í `core/urls.py`:

```python
# core/urls.py
from django.urls import path
from .views import OrdersListView

urlpatterns = [
    path("orders/", OrdersListView.as_view(), name="orders_list"),
]
```

–ó–¥–µ—Å—å `get_queryset` –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏–∫–∏ –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–Ω–µ–µ –±—ã–ª–∞ –≤ Function-Based View. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è `select_related` –∏ `prefetch_related` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Ö–æ—Ä–æ—à–µ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å–æ —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏.

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

Class-Based Views –≤ Django –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –º–æ—â–Ω—ã–π –∏ –≥–∏–±–∫–∏–π —Å–ø–æ—Å–æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏–∫–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π. –ò—Å–ø–æ–ª—å–∑—É—è –±–∞–∑–æ–≤—ã–µ `View`, `TemplateView`, `DetailView` –∏ `ListView`, –∞ —Ç–∞–∫–∂–µ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–∏–∫—Å–∏–Ω—ã, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —á–∏—Å—Ç—ã–π, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏ –ª–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π –∫–æ–¥. –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∏—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ –º–µ—Ç–æ–¥–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –Ω—É–∂–¥—ã –ø—Ä–æ–µ–∫—Ç–∞, –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.
